<!doctype html>
<html>
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Transpool</title>

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

	<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,300,200' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" href="demo/css/normalize.css">
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="http://glitchbone.github.io/HumbleGS/dist/humblegs.css">
    <link rel="stylesheet" href="dist/jquery.fatNav.min.css">
    <link rel="stylesheet" href="demo/css/main.css">
    <link rel="stylesheet" type="text/css" href="cards/wKEwRL.css">
    <link rel="stylesheet/less" type="text/css" href="cards/wKEwRL.less">
    <link rel="stylesheet" href="modal/css/iziModal.min.css">
    <link rel="stylesheet" type="text/css" href="upload/upload.scss">
    <link rel="stylesheet" href="notifications/toastr.css" />
    <link rel="stylesheet" href="chat/chat.css" />
    <link rel="stylesheet" href="online/online.css" />
    <link rel="stylesheet" type="text/css" href="online/online.scss">
</head>

<body>

<!--        Start of Menu Options-->
    <div class="fat-nav">
        <div class="fat-nav__wrapper">
            <ul>
                <li><a href="#" class="trigger" data-izimodal-open="#show-transfers-modal" data-izimodal-transitionin="fadeInDown">Show Transfers</a></li>
                <li><a href="#" class="trigger" data-izimodal-open="#import-money-modal" data-izimodal-transitionin="fadeInDown">Import Money</a></li>
                <li><a href="#">Logout</a></li>
            </ul>
        </div>
    </div>
<!--        End of Menu Options-->

    <div class="header">
        <h1>Welcome To Transpool</h1>
    </div>
    <!--    Start of Online Users-->
    <div class="wrapper" style="left: 2px;" >
        <input type="checkbox" id="trigger">
        <label id="trigger-input" for="trigger"  ></label>

        <div id="online-users" class="list-container">
            <ul>
<!--                <li><a href="#">Moshe</a></li>-->
<!--                <li><a href="#">List Item</a></li>-->
<!--                <li><a href="#">List Item</a></li>-->
            </ul>
        </div>
    </div>
    <!--        End of Online Users-->


<!--    Start of cards-->
    <div class="container" style="z-index: 100;">

        <div class="row">

            <div class="col-md-12">

                <div class="text-center" style="top: 10px">

                    <h2>Maps</h2>

                    <div class="cards" id="cards-container">

                        <div class="card">
                            <div class="card__image-holder" style="background: white">
                                <img class="card__image" src="cards/add_map.png" style="width: 300px; height: 264px;" alt="wave" />
                            </div>
                            <div class="card-title">
                                <a href="#" class="toggle-info btn">
                                    <span class="left"></span>
                                    <span class="right"></span>
                                </a>
                                <h2>
                                    Create New Map
                                    <small>using XML file</small>
                                </h2>
                            </div>
                            <div class="card-flap flap1">
                                <div class="card-description">
                                    Upload a new map using a valid XML file.
                                </div>
                                <div class="card-flap flap2">
                                    <div class="card-actions">
                                        <a href="#" class="btn" data-izimodal-open="#upload-modal" data-izimodal-transitionin="fadeInDown">Upload </a>
<!--                                        <a href="#" class="btn">Upload</a>-->
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

        </div>

    </div>

    <!--    End of cards-->

    <!--        Start of popup windows-->
    <div id="upload-modal" data-iziModal-fullscreen="false"  data-iziModal-title="Upload Map" >
    </div>
    <div id="import-money-modal" data-iziModal-fullscreen="false"  data-iziModal-title="Import Money" >
    </div>
    <div id="show-transfers-modal"  data-iziModal-fullscreen="false"  data-iziModal-title="Transfers" >
    </div>
<!--        End of popup windows-->
<!--    Start of chatbox-->
    <section class="chatbox js-chatbox" >
        <div class="chatbox__header">
            <h3 class="chatbox__header-cta-text"><span class="chatbox__header-cta-icon"><i
                    class="fas fa-comments"></i></span>Chat</h3>
            <button class="js-chatbox-toggle chatbox__header-cta-btn u-btn"><i class="fas fa-chevron-up"></i></button>
        </div>
        <!-- End of .chatbox__header -->
        <div class="js-chatbox-display chatbox__display">

        </div>
        <!-- End of .chatbox__display -->
        <form class="js-chatbox-form chatbox__form">
            <input type="text" class="js-chatbox-input chatbox__form-input" placeholder="Type your message..." required>
            <button class="chatbox__form-submit u-btn"><i class="fas fa-paper-plane"></i></button>
        </form>
        <!-- End of .chatbox__form -->
    </section>
    <!-- End of .chatbox -->


<!--DUMMY DATA STARTS HERE-->
<div class="dummyMapCard" style="display: none;">
    <div class="card map-card">
        <div class="card__image-holder">
            <img class="card__image" src="cards/map_icon.jpg" style="width: 300px; height: 264px;" alt="beach" />
        </div>
        <div class="card-title">
            <a href="#" class="toggle-info btn">
                <span class="left"></span>
                <span class="right"></span>
            </a>
            <h2 class="map-name">
                <span class="map-name">Tel Aviv </span>
                <small class="created-by">Created by Andrey</small>
            </h2>
        </div>
        <div class="card-flap flap1">
            <div class="card-description">
            </div>
            <div class="card-flap flap2">
                <div class="card-actions">
                    <a class="btn" data-id="17">Enter</a>
                </div>
            </div>
        </div>
    </div>
</div>
<!--DUMMY DATA ENDS HERE-->


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script type="text/javascript" src="dist/jquery.fatNav.min.js"></script>
    <script type="text/javascript" src="demo/js/main.js"></script>
    <script type="text/javascript" src="../../jquery-3.5.1.min.js"></script>
    <script type="text/javascript" src="cards/wKEwRL.js"></script>
    <script src="modal/js/iziModal.min.js" type="text/javascript"></script>
    <script src="upload/upload.js" type="text/javascript"></script>
    <script src="notifications/toastr.js"></script>
    <script src="chat/chat.js" type="text/javascript"></script>
    <script src="online/online.js" type="text/javascript"></script>
    <script>
        // $("#import-money-modal").iziModal();
        // $("#show-transfers-modal").iziModal();


        $("#upload-modal").iziModal({
            iframe: true,
            iframeHeight: 418,
            width: 418,
            iframeURL: "upload/upload.html",
            onClosed: function () {
                updateMapCards();
            }
        });

        $("#import-money-modal").iziModal({
            iframe: true,
            iframeHeight: 418,
            width: 418,
            iframeURL: "sub_import/import.html"
        });

        $("#show-transfers-modal").iziModal({
            iframe: true,
            iframeHeight: 550,
            width: 800,
            iframeURL: "sub_transactions/transactions.html"
        });


        $( setInterval(function() {toastr.warning('Welcome!');}, 5000));

    </script>

    <script>

        function clearMapCards() {
            $("#cards-container").find("div.map-card").remove();
        }

        function addMapCard(mapObj) {
            var mapNode = $("div.dummyMapCard div.map-card")[0].cloneNode(true);

            $(mapNode).find("h2.map-name span.map-name").text(mapObj.mapName);
            $(mapNode).find("h2.map-name small.created-by").text("Created by " + mapObj.mapOwner.name);

            var htmlNodeToAdd = "<div>Rides: " + mapObj.numOfRides + "</div>" +
                "<div>Matched tremps: " + mapObj.numOfMatchedTremps + "/" + mapObj.numOfTremps + "</div>" +
                "<div>Size :" + mapObj.width + "x" + mapObj.height + "</div>";

            $(mapNode).find("div.card-description").append(htmlNodeToAdd);

            $(mapNode).find("div.card-actions a").attr("data-id", mapObj.id);
            // $(mapNode).click(function(e){
            //     exposeCardData(e);
            // });
            $("#cards-container").append(mapNode);


            initCardClicks();
            initAllCardsClickThrough();
        }

        function createMapCards(mapsArray){
            clearMapCards();
            mapsArray.forEach(function(map){
                addMapCard(map);
            });
        }
        function updateMapCards(){


            $.ajax({
                url: "/transpool_war_exploded/map",
                timeout: 2000,
                method: "GET",
                dataType: "json",
                success: function (data){
                    if (data !== null) {
                        createMapCards(data);
                    }
                },
                error: function (data) {
                    alert(data);
                }
            });
        }
        // create map cards
        $(function () {
            updateMapCards();
            initAllCardsClickThrough();
        });


        // function goToMapPage(id) {
        //     alert(id);
        //     parent.location='map/map.html' + "?mapID=" + id;
        //
        // }

        // $(function () {
        //     $("div.map-card div.card-actions a.btn").click(function () {
        //         var id = $(this).data("id");
        //         goToMapPage(id);
        //     });
        // });



    </script>
    <script src="mainpage.js" type="text/javascript"></script>
</body>
</html>