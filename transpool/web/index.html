<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>indexPage</title>
    <style type="text/css">
        html { visibility:hidden; }
    </style>
    <script type="text/javascript" src="jquery-3.5.1.min.js"></script>
    <script type="text/javascript">
        $(function () {
            $.ajax({
                url: "login",
                type: "GET",
                dataType: "json",
                success: function(resp) {
                    // var resp = $.parseJSON(r);
                    // alert(resp)
                    $("#greeting h1").text("Hello " + resp.name + "!");
                    // $("#greeting h1").text("Hello " + resp.username + "!");
                    document.getElementsByTagName("html")[0].style.visibility = "visible";
                },
                error: function(resp) {
                    //var resp = $.parseJSON(r);
                    // console.log(resp.responseJSON.redirect_to);
                    // for (d in xhr) console.log(xhr[d]);
                    // alert(xhr.toString());
                    document.getElementsByTagName("html")[0].style.visibility = "hidden";
                    window.location = resp.responseJSON.redirect_to;
                }
            });
        });
        // $(function () {
        //     $.ajax({
        //         url: "login",
        //         success: function(r) {
        //             var resp = $.parseJSON(r);
        //             if(!resp.sessionExist){
        //                 window.location = "pages/login/login.html";
        //             }
        //             else {
        //                 document.getElementsByTagName("html")[0].style.visibility = "visible";
        //                 $("#greeting h1").text("Hello " + resp.username + "!");
        //             }
        //         },
        //         // error: function () {
        //         //     console.error("Errorrrrrr");
        //         // }
        //     });
        //     // window.location = "pages/login/login.html";
        // });
        /////////////////////////////////
        $(function () {
            $("#test-btn").click(function(){
                $.ajax({
                    url: "login",
                    success: function(r) {
                        var json = $.parseJSON(r);
                        $("#test h1").text(json.msg);
                    },
                    error: function () {
                        console.error("Errorrrrrr");
                    }
                });
            });

        });

    </script>
</head>
<body>
<div id="test">
    <h1>Index page</h1>
</div>
<div id="greeting">
    <h1>Index page</h1>
</div>
<button id="test-btn">Test</button>
</body>
</html>