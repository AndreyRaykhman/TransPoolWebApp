<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>indexPage</title>
    <style type="text/css">
        html { visibility:hidden; }
    </style>
    <script type="text/javascript" src="jquery-3.5.1.min.js"></script>

    <script type="text/javascript">
        $(function () {
            $.ajax({
                url:  "login",
                type: "GET",
                dataType: "json",
                success: function(data) {
                    // var resp = $.parseJSON(r);
                    // alert(resp)
                    if ($.isEmptyObject(data)){
                        window.location = "pages/login/login.html";
                    }
                    else {
                        $("#greeting h1").text("Hello " + data.name + "!");
                        document.getElementsByTagName("html")[0].style.visibility = "visible";
                    }
                },
                // error: function(resp) {
                //     //var resp = $.parseJSON(r);
                //     // console.log(resp.responseJSON.redirect_to);
                //     // for (d in xhr) console.log(xhr[d]);
                //     // alert(xhr.toString());
                //     document.getElementsByTagName("html")[0].style.visibility = "hidden";
                //     window.location = resp.responseJSON.redirect_to;
                // }
            });
        });
        // $(function () {
        //     $.ajax({
        //         url: "login",
        //         success: function(r) {
        //             var resp = $.parseJSON(r);
        //             if(!resp.sessionExist){
        //                 window.location = "pages/login/login.html";
        //             }
        //             else {
        //                 document.getElementsByTagName("html")[0].style.visibility = "visible";
        //                 $("#greeting h1").text("Hello " + resp.username + "!");
        //             }
        //         },
        //         // error: function () {
        //         //     console.error("Errorrrrrr");
        //         // }
        //     });
        //     // window.location = "pages/login/login.html";
        // });
        /////////////////////////////////
        $(function () {
            $("#test-btn").click(function(){
                $.ajax({
                    url: "login",
                    success: function(r) {
                        var json = $.parseJSON(r);
                        $("#test h1").text(json.msg);
                    },
                    error: function () {
                        console.error("Errorrrrrr");
                    }
                });
            });

        });

    </script>
</head>
<body>
<div id="test">
    <h1>Index page</h1>
</div>
<div id="greeting">
    <h1>Index page</h1>
</div>
<button id="test-btn">Test</button>
<form id="main1-form" action="pages/main1/wKEwRL.html" >
        <input type="submit" name="submit" value="Try main1" >
</form>
<form id="main2-form" action="pages/main2/LGRxWJ.html" >
    <input type="submit" name="submit" value="Try main2" >
</form>
<form id="main3-form" action="pages/main3/mainpage.html" >
    <input type="submit" name="submit" value="Try main3" >
</form>
<form id="main4-form" action="pages/with_modal/mainpage.html" >
    <input type="submit" name="submit" value="Try with_modal" >
</form>
<form id="main5-form" action="pages/with_upload/upload/upload.html" >
    <input type="submit" name="submit" value="Try upload" >
</form>
<form id="main6-form" action="pages/with_upload2/mainpage.html" >
    <input type="submit" name="submit" value="Try with upload" >
</form>
<form id="main7-form" action="pages/v8_chat/mainpage.html" >
    <input type="submit" name="submit" value="V8" >
</form>
<form id="main9-form" action="pages/v9_import_money/mainpage.html" >
    <input type="submit" name="submit" value="V9" >
</form>
<form id="main10-form" action="pages/v10_transactions/mainpage.html" >
    <input type="submit" name="submit" value="V10" >
</form>
<form id="main11-form" action="pages/v11_online/mainpage.html" >
    <input type="submit" name="submit" value="V11" >
</form>
<form id="main12-form" action="pages/v12_map/mainpage.html" >
    <input type="submit" name="submit" value="V12" >
</form>

</body>
</html>